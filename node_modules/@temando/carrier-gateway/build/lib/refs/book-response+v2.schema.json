{
  "id": "http://carrier-gateway.temando.com/schema/book-response+v2#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "type": "object",
  "allOf": [{
    "$ref": "#/definitions/bookingServiceResponse"
  }],
  "definitions": {
    "bookingServiceResponse": {
      "required": [
        "integrationId"
      ],
      "properties": {
        "clientId": {
          "type": "string"
        },
        "integrationId": {
          "type": "string"
        }
      },
      "oneOf": [{
        "$ref": "#/definitions/failedBooking"
      }, {
        "$ref": "#/definitions/successfulBooking"
      }]
    },
    "failedBooking": {
      "required": ["failedBooking"],
      "properties": {
        "failedBooking": {
          "type": "object",
          "required": ["reason"],
          "properties": {
            "reason": {
              "type": "array",
              "items": {
                "type": ["string", "object"]
              },
              "minItems": 1
            }
          }
        }
      }
    },
    "successfulBooking": {
      "required": ["successfulBooking"],
      "properties": {
        "successfulBooking": {
          "type": "object",
          "properties": {
            "integrationServiceId": {
              "type": "string"
            },
            "bookingReference": {
              "type": "string"
            },
            "shippingTaxInclusiveCharge": {
              "type": "object",
              "properties": {
                "amount": {
                  "type": ["number", "string"]
                },
                "currency": {
                  "type": "string"
                }
              },
              "required": [
                "amount",
                "currency"
              ]
            },
            "pricedAt": {
              "type": "string"
            },
            "label": {
              "type": "object",
              "properties": {
                "encoding": {
                  "type": "string"
                },
                "format": {
                  "type": "string"
                }
              },
              "oneOf": [{
                "$ref": "#/definitions/labelData"
              }, {
                "$ref": "#/definitions/labelUrl"
              }],
              "required": [
                "encoding",
                "format"
              ]
            }
          },
          "required": [
            "integrationServiceId",
            "bookingReference",
            "shippingTaxInclusiveCharge",
            "pricedAt"
          ]
        }
      }
    },
    "labelData": {
      "properties": {
        "data": {
          "type": "string"
        }
      },
      "required": ["data"]
    },
    "labelUrl": {
      "properties": {
        "url": {
          "type": "string",
          "format": "uri"
        }
      },
      "required": ["url"]
    }
  }
}
