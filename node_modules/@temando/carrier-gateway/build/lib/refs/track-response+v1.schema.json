{
  "id": "http://carrier-gateway.temando.com/schema/track-response+v1#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "description": "The generic tracking response schema",
  "type": "object",
  "required": [
    "integrationId",
    "pickedUp",
    "delivered",
    "shipmentEvents",
    "packageEvents"
  ],
  "allOf": [
    { "$ref": "#/definitions/trackingResponse" }
  ],
  "definitions": {
    "trackingResponse": {
      "properties": {
        "integrationId": {
          "description": "The identifier of the integration to you want to communicate with",
          "type": "string"
        },
        "pickedUp": {
          "type": "boolean",
          "description": "Shipment picked up"
        },
        "delivered": {
          "type": "boolean",
          "description": "Shipment delivered"
        },
        "pickedUpAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp at which the shipment was picked up"
        },
        "deliveredAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp at which the shipment was delivered"
        },
        "shipmentEvents": {
          "type": "array",
          "minItems": 0,
          "items": { "$ref": "#/definitions/trackingEvent" }
        },
        "packageEvents": {
          "type": "array",
          "minItems": 0,
          "items": { "$ref": "#/definitions/trackingEvent" }
        }
      }
    },
    "trackingEvent": {
      "type": "object",
      "description": "A tracking event and all associated data relating directly to it.",
      "required": [
        "trackingReference",
        "status",
        "rawStatus",
        "occurredAt"
      ],
      "properties": {
        "trackingReference": {
          "type": "string",
          "description": "The reference containing tracking events",
          "minLength": 1
        },
        "status": {
          "enum": [
            null,
            "at waypoint",
            "attempted delivery (card left)",
            "attempted delivery",
            "attempted pick up",
            "awaiting collection",
            "awaiting delivery",
            "awaiting pickup",
            "cancelled",
            "collected",
            "delayed",
            "delivered (unattended)",
            "delivered",
            "expired parcel collected by courier",
            "expired parcel",
            "expired reservation",
            "in transit",
            "issue occurred",
            "on board for delivery",
            "picked up",
            "returned to sender"
          ],
          "description": "The normalised tracking status which may be null if the raw status is not mapped"
        },
        "rawStatus": {
          "type": "string",
          "description": "The raw tracking status",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "description": "A description of the tracking event. E.g. Delivered by John Doe."
        },
        "occurredAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp at which the tracking event occurred"
        },
        "location": { "$ref": "#/definitions/address" },
        "signeeName": {
          "type": "string",
          "description": "The name of the signee. E.g. Signature required service."
        },
        "documents": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/document"
          }
        }
      }
    },
    "document": {
      "type": "object",
      "required": [
        "category",
        "format",
        "content"
      ],
      "properties": {
        "category": {
          "enum": [
            "proof_of_delivery_image"
          ],
          "description": "The category of documentation"
        },
        "format": {
          "enum": [
            "gif",
            "png",
            "jpg",
            "pdf"
          ],
          "description": "The format of the content"
        },
        "content": {
          "type": "string",
          "description": "The base64 encoded content"
        }
      }
    },
    "address": {
      "allOf": [
        {
          "$ref": "http://carrier-gateway.temando.com/schema/generic/address+v1#"
        }
      ],
      "required": [
        "countryCode"
      ]
    }
  }
}
