{
  "workflow": {
    "id": "workflow.user.registration",
    "title": { "messageKey": "workflow.registerUser.title" },
    "steps": [
      {
        "id": "step.termsAndConditions",
        "type": "form",
        "title": {
          "messageKey": "workflow.registerUser.termsAndConditions.title"
        },
        "form": {
          "id": "termsAndConditions",
          "controlSets": [
            {
              "id": "termsAndConditions",
              "controls": [
                {
                  "id": "country",
                  "ref": "#/user/termsAndConditions/country",
                  "type": "dropdown",
                  "title": {
                    "messageKey": "form.country.label"
                  },
                  "defaultValue": {
                    "static": "au"
                  },
                  "dataSource": {
                    "trigger": {
                      "event": "onload"
                    },
                    "httpRequest": {
                      "url": "https://...enabledCountries",
                      "method": "GET"
                    }
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "termsAndConditions",
                  "ref": "#/user/termsAndConditions/termsAndConditions",
                  "type": "infoText",
                  "title": {
                    "messageKey": "form.termsAndConditions.label"
                  },
                  "dataSource": {
                    "trigger": {
                      "controlId": "country",
                      "event": "onchange"
                    },
                    "httpRequest": {
                      "url": "https://...termsAndConditions",
                      "method": "GET"
                    }
                  }
                },
                {
                  "id": "agreeTermsAndConditions",
                  "ref": "#/user/termsAndConditions/agreeTermsAndConditions",
                  "type": "choice",
                  "title": {
                    "messageKey": "form.termsAndConditions.agreeTermsAndConditions"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "acceptPrivacyPolicy",
                  "ref": "#/user/termsAndConditions/acceptPrivacyPolicy",
                  "type": "choice",
                  "title": {
                    "messageKey": "form.termsAndConditions.acceptPrivacyPolicy"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "httpRequest": {
            "url": "https://...",
            "method": "POST"
          }
        },
        "next": [
          {
            "stepId": "step.choosePlan",
            "label": {
              "messageKey": "ui.continueButton.label"
            }
          }
        ]
      },
      {
        "id": "step.choosePlan",
        "type": "choicesList",
        "title": {
          "messageKey": "workflow.registerUser.choosePlan.title"
        },
        "next": [
          {
            "value": "userPlans.free",
            "label": {
              "messageKey": "ui.common.select"
            },
            "description": {
              "messageKey": "workflow.registerUser.description.freePlan"
            },
            "done": true
          },
          {
            "value": "userPlans.planA",
            "label": {
              "messageKey": "ui.common.select"
            },
            "description": {
              "messageKey": "workflow.registerUser.description.planA"
            },
            "stepId": "step.billingInformation",
            "ref": "#/user/plan"
          },
          {
            "value": "userPlans.planB",
            "label": {
              "messageKey": "ui.common.select"
            },
            "description": {
              "messageKey": "workflow.registerUser.description.planB"
            },
            "stepId": "step.billingInformation",
            "ref": "#/user/plan"
          }
        ]
      },
      {
        "id": "step.billingInformation",
        "title": {
          "messageKey": "workflow.registerUser.billingInformation.title"
        },
        "type": "form",
        "form": {
          "controlSets": [
            {
              "id": "form.billingInformation",
              "controls": [
                {
                  "id": "name",
                  "ref": "#/user/bilingInformation/name",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.name"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "email",
                  "ref": "#/user/bilingInformation/email",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.email"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "company",
                  "ref": "#/user/bilingInformation/company",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.company"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "abn",
                  "ref": "#/user/bilingInformation/abn",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.abn"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "address1",
                  "ref": "#/user/bilingInformation/address1",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.address1"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "address2",
                  "ref": "#/user/bilingInformation/address2",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.address2"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "country",
                  "ref": "#/user/bilingInformation/country",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.country"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ],
                  "defaultValue": {
                    "stateRef": "#/form/termsAndConditions/valueByControlId/country"
                  }
                },
                {
                  "id": "city",
                  "ref": "#/user/bilingInformation/city",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.city"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "postcode",
                  "ref": "#/user/bilingInformation/postcode",
                  "type": "text",
                  "title": {
                    "messageKey": "form.billingInformation.postcode"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "useForShippingOrigin",
                  "ref": "#/user/bilingInformation/useForShippingOrigin",
                  "type": "choice",
                  "title": {
                    "messageKey": "user.billingDetails.useForShippingOrigin.label"
                  },
                  "value": "Use same address for shipping origin",
                  "uiMeta": {
                    "yesNoConfiguration": true
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "httpRequest": {
            "url": "https://example.com",
            "method": "POST"
          }
        },
        "next": [
          {
            "stepId": "step.billingDetails",
            "label": {
              "messageKey": "ui.submitButton.label"
            }
          }
        ]
      },
      {
        "id": "step.creditCard",
        "title": {
          "messageKey": "workflow.registerUser.creditCard.title"
        },
        "type": "form",
        "form": {
          "controlSets": [
            {
              "id": "form.creditCard",
              "controls": [
                {
                  "id": "nameOnCard",
                  "ref": "#/user/creditCard/nameOnCard",
                  "type": "text",
                  "title": {
                    "messageKey": "form.creditCard.nameOnCard"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "cardNumber",
                  "ref": "#/user/creditCard/cardNumber",
                  "type": "number",
                  "title": {
                    "messageKey": "form.creditCard.cardNumber"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "expirationDate",
                  "ref": "#/user/creditCard/expirationDate",
                  "type": "date",
                  "title": {
                    "messageKey": "form.creditCard.expirationDate"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                },
                {
                  "id": "ccv",
                  "ref": "#/user/creditCard/ccv",
                  "type": "number",
                  "title": {
                    "messageKey": "form.creditCard.ccv"
                  },
                  "validation": [
                    {
                      "rule": "required",
                      "messages": {
                        "required": {
                          "messageKey": "form.common.required"
                        }
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "httpRequest": {
            "url": "https://...",
            "method": "POST"
          }
        },
        "next": [
          {
            "done": true,
            "label": {
              "messageKey": "ui.submitButton.label"
            }
          }
        ]
      }
    ]
  },
  "included": {
    "messages": {
      "ui.submitButton.label": "Submit",
      "form.common.required": "Required"
    }
  }
}
