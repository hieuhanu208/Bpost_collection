# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](http://keepachangelog.com/en/1.0.0/) and this project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0.html).

## [Unreleased][]

## [2.4.1][] - 2017-09-18
### Changes
* Fixed headers interface so as to not use `any` as the type for headers, leading to unpredictable behaviours on TS runtime compilation.

## [2.4.0][] - 2017-09-15

### Changes
 * `ServiceClient.request()` uses `aws4` to sign requests made to other services.

## [2.3.2][] - 2017-09-06
### Changes
 * Removed mandatory validation on Call Depth for `ServiceClientFactory.constructor()` (It is mandatory for creating `ServiceClient` still though, this is simply fixing it to be consistent with the interface type).

## [2.3.1][] - 2017-08-29
### Fixed
 * Added `await` on `ServiceClient.stream()`, `ServiceClient.message()` and `ServiceClient.enqueue()` methods as they weren't emitting the `<type>.end` event result as an object but as a promise.

## [2.3.0][] - 2017-08-28

### Added

 * Added `registerService` function to allow services to be registered to `ServiceClientFactory` post-instantiation
 * Replaced JS errors with custom Temando errors

### Fixed

 * Removed `accountId`, `sovereignty` and `code` from `IDeployments` type as they are not necessary
 * Added `at`, `$schema` and `version` as optional fields on IDeployments type
 * Use array of `IDeployments` in `ITemandoEnvironment` type instead of inline type

## [2.2.0][] - 2017-08-19
### Added
- Interfaces for Events emitted
- `ServiceClient.stream (name: string, config: Def.IStreamConfig)` support now supports `ExplicitHashKey` and `SequenceNumberForOrdering` parameters in the AWS Kinesis API.
### Changes
- Improved Events from each ServiceClient method, added more useful information

## [2.1.0][] - 2017-08-14

### Added

- `ServiceClientFactory` now extends `EventEmitter`
- The event `serviceClientFactory.on('create', (serviceClient: ServiceClient) => {})` is now available

## [2.0.0][] - 2017-08-14

See the [migration guide](docs/MIGRATION_GUIDE.md#migrating-from-v1x-to-v2x) for more details.

### Added

- Added `serviceName` to all emitted `ServiceClient` events.

### Changed

- **BREAKING** Renamed `ServiceClientFactory` configuration properties:
  - renamed `definitions` to `tsDefinition`
  - renamed `environment` to `tsEnv`

## [1.0.0][] - 2017-08-11

This is a complete rewrite of Service Client Factory from Javascript to Typescript. There is a high chance that all existing interfaces/methods have been BC broken in this release.

See the [migration guide](docs/MIGRATION_GUIDE.md#migrating-from-v072-to-v1x) for more details.

### Added

- TypeScript support, TS Lint, TypeDoc documentation generation
- Added support for Amazon SNS and Amazon Kinesis
- YAML support for `ts-definition` and `ts-env` files
- Default headers to be added for every request
- This shiny new `CHANGELOG.md` and `CONTRIBUTING.md`
- New mandatory request headers - `Code`, `Account-Id`, `X-Temando-Service-Call-Depth` and `Sovereignty`

### Changed

- Broke compatibility with all the interfaces/methods see [migration guide](docs/MIGRATION_GUIDE.md#migrating-from-v0.7.2-to-v1.x) for details
- Replaced methods for http requests with a single `request()` and updated `enqueue()` to the new interface format
- `ServiceClient` now extends Node's `EventEmitter` class
- Renamed `build/` to `dist/` to keep consistent with convention
- Updated documentation to support use of the new re-written library
- Replaced `axios` library with WHATWG Fetch standard using `isomorphic-fetch`
- Replaced `eslint` with `tslint`
- Replaced `mocha` and `chai` with `jest`

### Removed

- All `babel` related packages have been removed, they are no longer required.

## [0.7.2][] - 2017-03-27
### Fixed
- Fix broken loading of dependency files

## [0.7.1][] - 2017-03-27
### Removed
- Removed dependency on `babel-polyfill` by removing `Object.values()` and `Object.includes()` requirements

## [0.7.0][] - 2017-03-24
### Added
- Added `ServiceClientFactory.getServiceUrl()` method into the library

## [0.6.1][] - 2017-07-03
### Fixed
- Restore build section in `package.json`

## [0.6.0][] - 2017-07-03
### Changed
- Clean up loading of `ts-definition.json` and `ts-env.json` in the `constructor()` by moving the function loading code to utility functions
- Use validation

## [0.5.5][] - 2016-10-14
### Changed
- Upgraded `aws-sdk` to `2.6`
### Added
- Addition of pre-build stages and build artifacts to Gitlab CI

## [0.5.4][] - 2016-10-13
### Fixed
- Moved aws-sdk back to a dependency

## [0.5.3][] - 2016-10-13
### Changed
- Moved aws-sdk to a peer dependency

## [0.5.2][] - 2016-10-10
### Changed
- Improved documentation in `README.md` file

## [0.5.1][] - 2016-09-12
### Changed
- Improved Unit testing for creation of Service Client Factory instantiation without request reference being passed in

## [0.5.0][] - 2016-09-05
### Added
- Added setter/getter functions for the service name
- Added support for defining Service Queues using Amazon SQS
- Added mock tests for enqueueing messages into SQS and http requests/responses

## [0.4.0][] - 2016-08-18
### Changed
- Improved schema validation by using `@temando/service-registry-lib` schema validation for `ts-definition.json` and `ts-env.json` files

## [0.3.0][] - 2016-08-17
### Changed
- Added `babel-runtime` as dependency

## [0.2.9][] - 2016-08-16
### Changed
- Added `keyValues` to `ts-definition.json` schema
### Fixed
- Fixed typos in `.npmignore`

## [0.2.8][] - 2016-08-15
### Changed
- Continued work on documentation upgrades
- `package.json` cleanup

## [0.2.7][] - 2016-08-15
### Changed
- Documentation Updates

## [0.2.6][] - 2016-08-12
### Changed
- Restructured source files

## [0.2.5][] - 2016-08-12
### Changed
- Node 4.x compatibility changes

## [0.2.4][] - 2016-08-12
### Changed
- Environment schema upgrades
- Changed the main location for the source code build in `package.json`

## [0.2.3][] - 2016-08-08
### Changed
- Cleaned up debug in unit tests
- Fixed linting issues

## [0.2.2][] - 2016-08-08
### Added
- Added axios mock unit tests
- Added `.eslintrc` to for test package
- Added `enqueue()` method to Service Client class to enqueue data into SQS
- Added `aws-sdk` to `package.json`
### Changed
- Updated environment schema to new format

## [0.2.1][] - 2016-08-03
### Added
- Added `babel-cli` package to `package.json`
### Changed
- Updated `README.md`

## [0.2.0][] - 2016-08-03
### Fixed
- Bugfix for request reference

## [0.1.0][] - 2016-08-03
### Added
- Initial release

[Unreleased]: https://src.temando.io/service-registry/service-client-factory/compare/v2.4.1...HEAD
[2.4.1]: https://src.temando.io/service-registry/service-client-factory/compare/v2.4.0...v2.4.1
[2.4.0]: https://src.temando.io/service-registry/service-client-factory/compare/v2.3.2...v2.4.0
[2.3.2]: https://src.temando.io/service-registry/service-client-factory/compare/v2.3.1...v2.3.2
[2.3.1]: https://src.temando.io/service-registry/service-client-factory/compare/v2.3.0...v2.3.1
[2.3.0]: https://src.temando.io/service-registry/service-client-factory/compare/v2.2.0...v2.3.0
[2.2.0]: https://src.temando.io/service-registry/service-client-factory/compare/v2.1.0...v2.2.0
[2.1.0]: https://src.temando.io/service-registry/service-client-factory/compare/v2.0.0...v2.1.0
[2.0.0]: https://src.temando.io/service-registry/service-client-factory/compare/v1.0.0...v2.0.0
[1.0.0]: https://src.temando.io/service-registry/service-client-factory/compare/v0.7.2...v1.0.0
[0.7.2]: https://src.temando.io/service-registry/service-client-factory/tree/v0.7.2
[0.7.1]: https://src.temando.io/service-registry/service-client-factory/tree/v0.7.1
[0.7.0]: https://src.temando.io/service-registry/service-client-factory/tree/v0.7.0
[0.6.1]: https://src.temando.io/service-registry/service-client-factory/tree/v0.6.1
[0.6.0]: https://src.temando.io/service-registry/service-client-factory/tree/v0.6.0
[0.5.5]: https://src.temando.io/service-registry/service-client-factory/tree/v0.5.5
[0.5.4]: https://src.temando.io/service-registry/service-client-factory/tree/v0.5.4
[0.5.3]: https://src.temando.io/service-registry/service-client-factory/tree/v0.5.3
[0.5.2]: https://src.temando.io/service-registry/service-client-factory/tree/v0.5.2
[0.5.1]: https://src.temando.io/service-registry/service-client-factory/tree/v0.5.1
[0.5.0]: https://src.temando.io/service-registry/service-client-factory/tree/v0.5.0
[0.4.0]: https://src.temando.io/service-registry/service-client-factory/tree/v0.4.0
[0.3.0]: https://src.temando.io/service-registry/service-client-factory/tree/v0.3.0
[0.2.9]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.9
[0.2.8]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.8
[0.2.7]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.7
[0.2.6]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.6
[0.2.5]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.5
[0.2.4]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.4
[0.2.3]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.3
[0.2.2]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.2
[0.2.1]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.1
[0.2.0]: https://src.temando.io/service-registry/service-client-factory/tree/v0.2.0
[0.1.0]: https://src.temando.io/service-registry/service-client-factory/tree/v0.1.0
