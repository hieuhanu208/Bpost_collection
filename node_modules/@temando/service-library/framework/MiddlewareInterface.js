"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("../utils");
const empty = () => undefined;
function MiddlewareInterface(mediator, inputCallback = empty) {
    // Staggered to the process.nextTick() each time it's called
    const validate = utils_1.stagger(mediator.validate, 0);
    const callback = inputCallback;
    callback.use = (middleware) => {
        if (Array.isArray(middleware)) {
            for (const mw of middleware) {
                mw(mediator);
            }
        }
        else {
            middleware(mediator);
        }
        validate();
        return callback;
    };
    callback.mediator = mediator;
    return callback;
}
exports.MiddlewareInterface = MiddlewareInterface;
//# sourceMappingURL=MiddlewareInterface.js.map