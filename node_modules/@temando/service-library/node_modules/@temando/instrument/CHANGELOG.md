# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](http://keepachangelog.com/en/1.0.0/)
and this project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [4.1.1][] - 2017-09-21

### Changed

- Metrics now allows for `number` values. Previously it only allowed for `integers`.

### Fixed

- `InstrumentClient` has more complete Typescript typings.
- Add `.editorconfig` file to this project.

## [4.1.0][] - 2017-09-19

### Added

- `InstrumentClient` has a new method, `histogram`.

### Changed

- Internally, `timing` metrics now map to `histogram`.

## [4.0.0][] - 2017-09-18

### Changed

- `timing()` can now accepts a timer as a value.
- `timer()` no longer needs an action!

### Breaking Changes

- `timerCommit()` has been deleted.
- `timerStart()` has been deleted.
- `timerEnd()` has been deleted.
- `timers()` has been deleted.

## [3.0.3][] - 2017-09-18

### Fixed

- Fix `ITags` typing to allow numbers, as well as strings.

## [3.0.2][] - 2017-09-18

### Fixed

- Fix Typescript function overloads for `InstrumentClient` so they are ordered most specific to least specific. [See Do's and Don'ts](https://www.typescriptlang.org/docs/handbook/declaration-files/do-s-and-don-ts.html#function-overloads).

## [3.0.1][] - 2017-09-15

### Fixed

- `DatadogLogMetrics` plugin learnt how to write timing data, using histogram.
- `InstrumentClient.count` defaults `value` to 1 when not provided. This restores the v1.x behaviour.
- Add CHANGELOG controls (`yarn version`)
- Update README so that it's accurate!

## [3.0.0] - 2017-08-19

### Changes

- Internally, `InstrumentGatewayClient` is now `InstrumentClient`
- Both `InstrumentGatewayClient` and `InstrumentClient` are still exported from the library

### Removed

- `InstrumentClient.events` (use root event emitter)
- `InstrumentClient.flush()`
- `InstrumentClient.close()`
- `CollectLogMetrics` and `FlushToGateway`

### Deprecated

- `InstrumentClient.timerStart()` (use `InstrumentClient.timer`)

## [2.0.0] - 2017-08-14

Breaking Changes:

- Instrumentalize lambdas have been removed as `service-library` supercedes them
- Requires `>= node@6` runtime

Features:

- `InstrumentGatewayClient` has a new method: `.tag(key, value)`
  - This allows one to attach global values, tags, to the instance
  - These tags will be supplied to the `DatadogLogMetrics` logger for each event there after
- `InstrumentGatewayClient`'s call signature for has been enhanced to allow keyed objects for arguments in public methods associated with `tags`
- Types & call signatures have been added for most public methods
- `InstrumentGatewayClient` now extends EventEmitter. `client.on()` is avaliable, and `client.events.on()` is also there for backwards compat

Internal:

- Added new export `InstrumentClient`, so as to prepare for removing the gateway aspect
- TypeScript builds
- Jest
  - coverage (>80 lines)
  - Tests for built files
- lint (tslint-config-temando)
- CI is now using latest node image

Notes:

- Types are minimal currently pending further attention

[Unreleased]: https://src.temando.io/project-phoenix/instrument-library/compare/v4.1.1...HEAD
[4.1.1]: https://src.temando.io/project-phoenix/instrument-library/compare/v4.1.0...v4.1.1
[4.1.0]: https://src.temando.io/project-phoenix/instrument-library/compare/v4.0.0...v4.1.0
[4.0.0]: https://src.temando.io/project-phoenix/instrument-library/compare/v3.0.3...v4.0.0
[3.0.3]: https://src.temando.io/project-phoenix/instrument-library/compare/v3.0.2...v3.0.3
[3.0.2]: https://src.temando.io/project-phoenix/instrument-library/compare/v3.0.1...v3.0.2
[3.0.1]: https://src.temando.io/project-phoenix/instrument-library/compare/v3.0.0...v3.0.1
[3.0.0]: https://src.temando.io/project-phoenix/instrument-library/compare/v2.0.0...v3.0.0
[2.0.0]: https://src.temando.io/project-phoenix/instrument-library/compare/v1.4.3...v2.0.0
